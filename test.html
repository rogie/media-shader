<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <title>MediaShader Image Examples</title>
    <script src="media-shader.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .example {
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        h1,
        h2 {
            color: #333;
        }

        media-shader {

            margin: 20px 0;
        }
    </style>
</head>

<body>
    <h1>MediaShader Image Examples</h1>

    <media-shader width="30vw"
                  uniforms='{"u_background": [0, 0, 0, 1], "u_color": [0, 1, 0, 1], "u_scale": 1.0, "u_speed": 0.1, "u_phase": 0.5, "u_brightness": 1.0, "u_resolution": [1024, 1024] }'
                  fragment-shader="precision highp float;
                                      uniform float u_time;
                        uniform vec2 u_resolution;
                        uniform vec4 u_background;
                        uniform vec4 u_color;
                        uniform float u_speed;//units:%
                        uniform float u_phase;//units:%
                        
                        uniform float u_scale;//units:%
                        uniform float u_brightness;//units:%
                        
                        vec2 rotate(vec2 uv, float th) {
                          return mat2(cos(th), sin(th), -sin(th), cos(th)) * uv;
                        }
                        
                        float neuro_shape(vec2 uv, float t) {
                          vec2 sine_acc = vec2(0.);
                          vec2 res = vec2(0.);
                          float scale = 8.;
                        
                          for (int j = 0; j < 15; j++) {
                            uv = rotate(uv, 1.);
                            sine_acc = rotate(sine_acc, 1.);
                            vec2 layer = uv * scale + float(j) + sine_acc - t;
                            sine_acc += sin(layer);
                            res += (.5 + .5 * cos(layer)) / scale;
                            scale *= (1.2);
                          }
                          return res.x + res.y;
                        }
                        
                        void main() {
                          vec2 uv = gl_FragCoord.xy / u_resolution.xy;
                        
                          uv -= .5;
                          float scale = .75 * u_scale + 1e-4;
                          uv *= (.001 * (1. - step(1. - scale, 1.) / scale));
                          uv *= u_resolution;
                          uv += .5;
                        
                          float t = u_time * u_speed + u_phase*10.;
                        
                          float noise = neuro_shape(uv, t);
                        
                          noise = u_brightness * pow(noise, 3.);
                          noise += pow(noise, 12.);
                          noise = max(.0, noise - .5);
                        
                          vec3 color = mix(u_background.rgb * u_background.a, u_color.rgb * u_color.a, noise);
                          float opacity = mix(u_background.a, u_color.a, noise);
                        
                          gl_FragColor = vec4(color, opacity);
                        }"></media-shader>

    <div class="example">
        <h2>Basic Image Display (No Fragment Shader)</h2>
        <p>This example shows an image displayed without any shader effects:</p>
        <media-shader width="30vw"
                      src="https://picsum.photos/640/360">
        </media-shader>
    </div>

    <div class="example">
        <h2>Image with Fragment Shader Effect</h2>
        <p>This example applies a cool wave distortion effect to the image:</p>
        <media-shader src="https://picsum.photos/640/360"
                      fragment-shader="precision highp float;
                uniform sampler2D uTexture;
                uniform vec2 uResolution;
                uniform float uTime;
                varying vec2 vTexCoord;

                void main() {
                    vec2 uv = vTexCoord;
                    float wave = sin(uv.y * 10.0 + uTime) * 0.02;
                    vec2 distortedUV = vec2(uv.x + wave, uv.y);
                    gl_FragColor = texture2D(uTexture, distortedUV);
                }">
        </media-shader>
    </div>

    <div class="example">
        <h2>Image with Fragment Shader Effect</h2>
        <p>This example applies a cool wave distortion effect to the image:</p>
        <media-shader width="50%"
                      src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                      loading="eager">
        </media-shader>
        <media-shader width="50%"
                      src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                      loading="eager">
        </media-shader>
    </div>


</body>

</html>